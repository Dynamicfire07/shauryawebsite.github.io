<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>DP1 Exam Countdown</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background-color: #f8f9fa; background: linear-gradient(120deg, #89f7fe, #66a6ff); }
    .exam-card { transition: transform 0.3s; cursor: pointer; background-color: white; box-shadow: 0 4px 8px rgba(0,0,0,0.2); border-radius: 10px; }
    .exam-card:hover { transform: scale(1.05); }
    .countdown { font-size: 1.2rem; }
    .modal-content { background-color: #f0f9ff; }
    .dropdown-menu { width: 100%; }
    .dropdown-menu .exam-card { margin-bottom: 10px; }
    .arrow {
      display: inline-block;
      transition: transform 0.3s;
    }
    .collapsed .arrow {
      transform: rotate(0deg);
    }
    .arrow.rotate {
      transform: rotate(90deg);
    }
  </style>
</head>
<body>
  <!-- Sticky Page Header -->
  <nav class="navbar navbar-light bg-light mb-4">
    <div class="container-fluid justify-content-center">
      <span class="navbar-brand mb-0 h1">DP1 Exam Assistant</span>
    </div>
  </nav>
  <div class="container my-5">
    <!-- Pomodoro and Export Calendar card -->
    <div class="card p-3 mb-4" style="background-color: #f7fbff;">
      <div class="row align-items-center">
        <div class="col-md-8 mb-3 mb-md-0">
          <div class="d-flex flex-column align-items-center">
            <h5 class="mb-2">‚è∞ Quick Pomodoro Timer</h5>
            <div>
              <button class="btn btn-outline-primary me-2" onclick="startTimer(30 * 60)">30 min Focus</button>
              <button class="btn btn-outline-success me-2" onclick="startTimer(5 * 60)">5 min Break</button>
              <button class="btn btn-outline-warning" onclick="startTimer(60 * 60)">1 hr Session</button>
            </div>
            <div id="pomodoroDisplay" class="mt-2 fw-bold">Ready</div>
          </div>
        </div>
        <div class="col-md-4 text-center">
          <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#calendarExportModal">
            üìÖ Export Calendar
          </button>
        </div>
      </div>
    </div>
    <h1 class="text-center mb-4">DP1 Term 2 Exam Countdown</h1>

    <!-- Accordion for subject sections -->
    <div class="accordion" id="subjectAccordion">
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingHindi">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#hindiCollapse" aria-expanded="false" aria-controls="hindiCollapse">
            Hindi
          </button>
        </h2>
        <div id="hindiCollapse" class="accordion-collapse collapse" aria-labelledby="headingHindi" data-bs-parent="#subjectAccordion">
          <div class="accordion-body p-0">
            <ul class="list-unstyled mb-0" id="hindiDropdown"></ul>
          </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingFrench">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#frenchCollapse" aria-expanded="false" aria-controls="frenchCollapse">
            French
          </button>
        </h2>
        <div id="frenchCollapse" class="accordion-collapse collapse" aria-labelledby="headingFrench" data-bs-parent="#subjectAccordion">
          <div class="accordion-body p-0">
            <ul class="list-unstyled mb-0" id="frenchDropdown"></ul>
          </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingSpanish">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#spanishCollapse" aria-expanded="false" aria-controls="spanishCollapse">
            Spanish
          </button>
        </h2>
        <div id="spanishCollapse" class="accordion-collapse collapse" aria-labelledby="headingSpanish" data-bs-parent="#subjectAccordion">
          <div class="accordion-body p-0">
            <ul class="list-unstyled mb-0" id="spanishDropdown"></ul>
          </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingEconomics">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#economicsCollapse" aria-expanded="false" aria-controls="economicsCollapse">
            Economics
          </button>
        </h2>
        <div id="economicsCollapse" class="accordion-collapse collapse" aria-labelledby="headingEconomics" data-bs-parent="#subjectAccordion">
          <div class="accordion-body p-0">
            <ul class="list-unstyled mb-0" id="economicsDropdown"></ul>
          </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingPsychology">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#psychologyCollapse" aria-expanded="false" aria-controls="psychologyCollapse">
            Psychology
          </button>
        </h2>
        <div id="psychologyCollapse" class="accordion-collapse collapse" aria-labelledby="headingPsychology" data-bs-parent="#subjectAccordion">
          <div class="accordion-body p-0">
            <ul class="list-unstyled mb-0" id="psychologyDropdown"></ul>
          </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingEnglish">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#englishCollapse" aria-expanded="false" aria-controls="englishCollapse">
            English Language & Literature
          </button>
        </h2>
        <div id="englishCollapse" class="accordion-collapse collapse" aria-labelledby="headingEnglish" data-bs-parent="#subjectAccordion">
          <div class="accordion-body p-0">
            <ul class="list-unstyled mb-0" id="englishDropdown"></ul>
          </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingBusiness">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#businessCollapse" aria-expanded="false" aria-controls="businessCollapse">
            Business Management
          </button>
        </h2>
        <div id="businessCollapse" class="accordion-collapse collapse" aria-labelledby="headingBusiness" data-bs-parent="#subjectAccordion">
          <div class="accordion-body p-0">
            <ul class="list-unstyled mb-0" id="businessDropdown"></ul>
          </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingChemistry">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#chemistryCollapse" aria-expanded="false" aria-controls="chemistryCollapse">
            Chemistry
          </button>
        </h2>
        <div id="chemistryCollapse" class="accordion-collapse collapse" aria-labelledby="headingChemistry" data-bs-parent="#subjectAccordion">
          <div class="accordion-body p-0">
            <ul class="list-unstyled mb-0" id="chemistryDropdown"></ul>
          </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingPhysics">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#physicsCollapse" aria-expanded="false" aria-controls="physicsCollapse">
            Physics
          </button>
        </h2>
        <div id="physicsCollapse" class="accordion-collapse collapse" aria-labelledby="headingPhysics" data-bs-parent="#subjectAccordion">
          <div class="accordion-body p-0">
            <ul class="list-unstyled mb-0" id="physicsDropdown"></ul>
          </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingComputerScience">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#computerScienceCollapse" aria-expanded="false" aria-controls="computerScienceCollapse">
            Computer Science
          </button>
        </h2>
        <div id="computerScienceCollapse" class="accordion-collapse collapse" aria-labelledby="headingComputerScience" data-bs-parent="#subjectAccordion">
          <div class="accordion-body p-0">
            <ul class="list-unstyled mb-0" id="computerScienceDropdown"></ul>
          </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingBiology">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#biologyCollapse" aria-expanded="false" aria-controls="biologyCollapse">
            Biology
          </button>
        </h2>
        <div id="biologyCollapse" class="accordion-collapse collapse" aria-labelledby="headingBiology" data-bs-parent="#subjectAccordion">
          <div class="accordion-body p-0">
            <ul class="list-unstyled mb-0" id="biologyDropdown"></ul>
          </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingESS">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#essCollapse" aria-expanded="false" aria-controls="essCollapse">
            ESS
          </button>
        </h2>
        <div id="essCollapse" class="accordion-collapse collapse" aria-labelledby="headingESS" data-bs-parent="#subjectAccordion">
          <div class="accordion-body p-0">
            <ul class="list-unstyled mb-0" id="essDropdown"></ul>
          </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingMath">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#mathCollapse" aria-expanded="false" aria-controls="mathCollapse">
            Math
          </button>
        </h2>
        <div id="mathCollapse" class="accordion-collapse collapse" aria-labelledby="headingMath" data-bs-parent="#subjectAccordion">
          <div class="accordion-body p-0">
            <ul class="list-unstyled mb-0" id="mathDropdown"></ul>
          </div>
        </div>
      </div>
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingTOK">
          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#tokCollapse" aria-expanded="false" aria-controls="tokCollapse">
            TOK
          </button>
        </h2>
        <div id="tokCollapse" class="accordion-collapse collapse" aria-labelledby="headingTOK" data-bs-parent="#subjectAccordion">
          <div class="accordion-body p-0">
            <ul class="list-unstyled mb-0" id="tokDropdown"></ul>
          </div>
        </div>
      </div>
    </div>

  <!-- Subject Selector Modal for Calendar Export -->
  <div class="modal fade" id="calendarExportModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Select Subjects to Export</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div id="subjectCheckboxes"></div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" onclick="exportCalendar()">Export Calendar (.ics)</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal fade" id="examModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="examTitle"></h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="examDetails"></div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    const exams = [
      { title: "Hindi B SL Paper 1", date: "2025-05-12T08:45:00", details: "1 Hour 15 Minutes", syllabus: ["Identities", "Experience", "Human Ingenuity", "Writing formats including letters, articles, emails, and reports"] },
      { title: "French B SL Paper 1", date: "2025-05-12T08:45:00", details: "1 Hour 15 Minutes", syllabus: ["Identities and experiences", "Human ingenuity", "Social organization", "Sharing the planet", "Writing and listening skills"] },
      { title: "French ab initio Paper 1", date: "2025-05-12T08:45:00", details: "1 Hour", syllabus: ["Basic communication", "Everyday life topics", "Cultural awareness", "Writing and listening skills"] },
      { title: "Spanish ab initio Paper 1 (Writing)", date: "2025-05-12T08:45:00", details: "1 Hour", syllabus: ["Basic communication", "Everyday life topics", "Cultural awareness", "Writing and listening skills"] },
      { title: "Spanish ab initio Paper 2 (Reading)", date: "2025-05-12T12:00:00", details: "1 Hour", syllabus: ["Reading comprehension", "Cultural awareness"] },
      { title: "Spanish ab initio Paper 3 (Listening)", date: "2025-05-12T15:00:00", details: "45 Minutes", syllabus: ["Listening comprehension", "Everyday communication"] },
      { title: "Hindi B HL/SL Paper 2", date: "2025-05-12T12:00:00", details: "1 Hour", syllabus: ["Identities", "Experience", "Human Ingenuity", "Writing formats including essays, commentaries, and creative writing"] },
      { title: "French B SL Paper 2", date: "2025-05-12T12:00:00", details: "1 Hour", syllabus: ["Text analysis", "Essay writing", "Literary appreciation"] },
      { title: "Economics HL Paper 2 & 3", date: "2025-05-13T08:45:00", details: "2 Hours 15 Minutes", syllabus: ["Competitive markets", "Elasticities", "Government intervention", "Market failure", "Macroeconomics (AD/AS)", "HL Paper 3 calculations"] },
      { title: "Economics SL Paper 2", date: "2025-05-13T08:45:00", details: "1 Hour 45 Minutes", syllabus: ["Competitive markets", "Elasticities", "Government intervention", "Market failure", "Macroeconomics (AD/AS)"] },
      { title: "Psychology HL Paper 1 & 3", date: "2025-05-13T08:45:00", details: "2 Hours", syllabus: ["Research methods", "Biological approach", "Cognitive approach", "Sociocultural approach", "Paper 3 HL extension"] },
      { title: "Psychology SL Paper 1", date: "2025-05-13T08:45:00", details: "2 Hours", syllabus: ["Research methods", "Biological approach", "Cognitive approach", "Sociocultural approach"] },
      { title: "English Language & Lit SL Paper 2", date: "2025-05-15T08:45:00", details: "1 Hour 45 Minutes", syllabus: ["Literary analysis", "Textual interpretation", "Writing skills"] },
      { title: "English Language & Lit HL Paper 2", date: "2025-05-15T08:45:00", details: "1 Hour 45 Minutes", syllabus: ["Comparison and contrast of two works of literature", "Critical analysis", "Essay writing"] },
      { title: "Business Management HL Paper 2", date: "2025-05-16T08:45:00", details: "1 Hour 45 Minutes", syllabus: ["Units 1 to 5 of syllabus", "Business Management Toolkit including decision making, leadership, and strategy"] },
      { title: "Chemistry HL Paper 1", date: "2025-05-16T08:45:00", details: "2 Hours", syllabus: ["Particulate nature of matter", "Bonding and structure", "Chemical reactions", "How much/how fast/how far (stoichiometry, kinetics, equilibrium)"] },
      { title: "Chemistry SL Paper 1", date: "2025-05-16T08:45:00", details: "1 Hour 30 Minutes", syllabus: ["Particulate nature of matter", "Bonding and structure", "Chemical reactions", "Quantitative chemistry"] },
      { title: "Chemistry HL Paper 2", date: "2025-05-16T12:00:00", details: "2 Hours 30 Minutes", syllabus: ["In-depth stoichiometry", "Advanced energetics", "Kinetics and equilibrium", "Acids and bases", "Redox reactions", "Organic chemistry including mechanisms"] },
      { title: "Chemistry SL Paper 2", date: "2025-05-16T12:00:00", details: "1 Hour 30 Minutes", syllabus: ["Stoichiometry", "Energetics", "Kinetics", "Equilibrium", "Acids and bases", "Redox"] },
      { title: "Physics HL Paper 1", date: "2025-05-19T08:45:00", details: "2 Hours", syllabus: ["Kinematics", "Forces and momentum", "Work, energy and power", "Rigid body mechanics", "Relativity", "Thermal energy", "Greenhouse effect"] },
      { title: "Computer Science SL Paper 1 & 2", date: "2025-05-19T08:45:00", details: "2 Hours", syllabus: ["System fundamentals", "Computer organization", "Networks", "Computational thinking", "Programming concepts", "Data structures"] },
      { title: "Biology HL Paper 1A and B", date: "2025-05-19T08:45:00", details: "2 Hours", syllabus: ["Cell biology", "Molecular biology", "Genetics", "Ecology", "Evolution and biodiversity", "Human physiology"] },
      { title: "Physics SL Paper 1", date: "2025-05-19T08:45:00", details: "1 Hour 30 Minutes", syllabus: ["Kinematics", "Forces", "Energy", "Waves", "Electricity and magnetism", "Atomic and nuclear physics"] },
      { title: "ESS Paper 1", date: "2025-05-19T08:45:00", details: "1 Hour", syllabus: ["Environmental systems", "Sustainability", "Human impacts", "Ecosystem interactions"] },
      { title: "Physics HL Paper 2", date: "2025-05-19T12:00:00", details: "2 Hours 30 Minutes", syllabus: ["Advanced mechanics", "Thermal physics", "Waves", "Electricity and magnetism", "Circular motion and gravitation", "Atomic and nuclear physics", "Data-based questions"] },
      { title: "Biology HL Paper 2", date: "2025-05-19T12:00:00", details: "2 Hours 30 Minutes", syllabus: ["Cell biology", "Molecular biology", "Genetics", "Ecology", "Evolution and biodiversity", "Human physiology"] },
      { title: "ESS Paper 2", date: "2025-05-19T12:00:00", details: "2 Hours", syllabus: ["Environmental systems", "Sustainability", "Human impacts", "Ecosystem interactions", "Fieldwork techniques"] },
      { title: "Physics SL Paper 2", date: "2025-05-19T12:00:00", details: "1 Hour 30 Minutes", syllabus: ["Mechanics", "Thermal physics", "Waves", "Electricity and magnetism", "Atomic and nuclear physics"] },
      { title: "Math AI HL Paper 1", date: "2025-05-20T08:45:00", details: "2 Hours", syllabus: ["Algebra", "Functions and equations", "Calculus", "Statistics and probability", "Modeling"] },
      { title: "Math AA HL Paper 1", date: "2025-05-20T08:45:00", details: "2 Hours", syllabus: ["Number and Algebra (standard form, sequences, complex numbers, binomial theorem)", "Functions (composite, inverse, transformations, factor theorem)", "Geometry and Trigonometry (radians, unit circle, circular functions, compound angles)", "Calculus (differentiation, chain/product/quotient rules, optimization, limits, first principles)"] },
      { title: "Math AI SL Paper 1", date: "2025-05-20T08:45:00", details: "1 Hour 30 Minutes", syllabus: ["Algebra", "Functions", "Calculus basics", "Statistics basics", "Modeling"] },
      { title: "Math AI HL Paper 2", date: "2025-05-20T12:00:00", details: "2 Hours", syllabus: ["Advanced algebra", "Advanced calculus", "Statistics and probability", "Mathematical modeling"] },
      { title: "Math AA HL Paper 2", date: "2025-05-20T12:00:00", details: "2 Hours", syllabus: ["Advanced functions", "Advanced calculus", "Statistics and probability", "Mathematical modeling"] },
      { title: "Math AI SL Paper 2", date: "2025-05-20T12:00:00", details: "1 Hour 30 Minutes", syllabus: ["Algebra", "Functions", "Calculus basics", "Statistics basics", "Modeling"] },
      { title: "TOK Assessed Work", date: "2025-05-21T08:45:00", details: "1 Hour 30 Minutes", syllabus: ["Knowledge questions", "Ways of knowing", "Areas of knowledge", "Critical thinking", "Essay writing"] }
    ];

    const subjectMap = {
      "Hindi": ["Hindi B SL Paper 1", "Hindi B HL/SL Paper 2"],
      "French": ["French B SL Paper 1", "French ab initio Paper 1", "French B SL Paper 2"],
      "Spanish": [
        "Spanish ab initio Paper 1 (Writing)",
        "Spanish ab initio Paper 2 (Reading)",
        "Spanish ab initio Paper 3 (Listening)"
      ],
      "Economics": ["Economics HL Paper 2 & 3", "Economics SL Paper 2"],
      "Psychology": ["Psychology HL Paper 1 & 3", "Psychology SL Paper 1"],
      "English Language & Literature": ["English Language & Lit SL Paper 2", "English Language & Lit HL Paper 2"],
      "Business Management": ["Business Management HL Paper 2"],
      "Chemistry": ["Chemistry HL Paper 1", "Chemistry SL Paper 1", "Chemistry HL Paper 2", "Chemistry SL Paper 2"],
      "Physics": ["Physics HL Paper 1", "Physics SL Paper 1", "Physics HL Paper 2", "Physics SL Paper 2"],
      "Computer Science": ["Computer Science SL Paper 1 & 2"],
      "Biology": ["Biology HL Paper 1A and B", "Biology HL Paper 2"],
      "ESS": ["ESS Paper 1", "ESS Paper 2"],
      "Math": ["Math AI HL Paper 1", "Math AA HL Paper 1", "Math AI SL Paper 1", "Math AI HL Paper 2", "Math AA HL Paper 2", "Math AI SL Paper 2"],
      "TOK": ["TOK Assessed Work"]
    };

    const dropdownIds = {
      "Hindi": "hindiDropdown",
      "French": "frenchDropdown",
      "Spanish": "spanishDropdown",
      "Economics": "economicsDropdown",
      "Psychology": "psychologyDropdown",
      "English Language & Literature": "englishDropdown",
      "Business Management": "businessDropdown",
      "Chemistry": "chemistryDropdown",
      "Physics": "physicsDropdown",
      "Computer Science": "computerScienceDropdown",
      "Biology": "biologyDropdown",
      "ESS": "essDropdown",
      "Math": "mathDropdown",
      "TOK": "tokDropdown"
    };

    const modal = new bootstrap.Modal(document.getElementById('examModal'));
    const examTitle = document.getElementById('examTitle');
    const examDetails = document.getElementById('examDetails');

    function updateCountdown() {
      const now = new Date().getTime();
      exams.forEach((exam, index) => {
        const examTime = new Date(exam.date).getTime();
        const distance = examTime - now;
        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((distance % (1000 * 60)) / 1000);
        const countdownElem = document.getElementById('countdown-' + index);
        if (countdownElem) {
          countdownElem.textContent = `${days}d ${hours}h ${minutes}m ${seconds}s`;
        }
      });
    }

    function showDetails(index) {
      examTitle.textContent = exams[index].title;
      examDetails.innerHTML = `<strong>Date:</strong> ${new Date(exams[index].date).toLocaleString()}<br>
                               <strong>Duration:</strong> ${exams[index].details}<br>
                               <strong>Syllabus:</strong><ul>${exams[index].syllabus.map(item => `<li>${item}</li>`).join('')}</ul>`;
      modal.show();
    }

    exams.forEach((exam, index) => {
      let subjectKey = null;
      for (const [subject, titles] of Object.entries(subjectMap)) {
        if (titles.includes(exam.title)) {
          subjectKey = subject;
          break;
        }
      }
      if (!subjectKey) {
        // If no subject found, skip or place in a default container (optional)
        return;
      }
      const dropdownId = dropdownIds[subjectKey];
      const dropdownElem = document.getElementById(dropdownId);
      if (dropdownElem) {
        const li = document.createElement('li');
        li.innerHTML = `
          <div class="card exam-card" style="cursor:pointer;" onclick="showDetails(${index})">
            <div class="card-body text-center p-2">
              <h6 class="card-title mb-1">${exam.title}</h6>
              <p class="mb-1">${new Date(exam.date).toLocaleString()}</p>
              <p class="mb-1">${exam.details}</p>
              <p class="countdown mb-0" id="countdown-${index}">Loading...</p>
            </div>
          </div>
        `;
        dropdownElem.appendChild(li);
      }
    });

    setInterval(updateCountdown, 1000);
    updateCountdown();

    // Generate subject checkboxes
    const subjectCheckboxes = document.getElementById('subjectCheckboxes');
    Object.keys(subjectMap).forEach(subject => {
      const div = document.createElement('div');
      div.className = 'form-check';
      div.innerHTML = `<input class="form-check-input" type="checkbox" value="${subject}" id="check-${subject}">
                       <label class="form-check-label" for="check-${subject}">${subject}</label>`;
      subjectCheckboxes.appendChild(div);
    });

    // Export calendar function
    function exportCalendar() {
      const selectedSubjects = [];
      Object.keys(subjectMap).forEach(subject => {
        const checkbox = document.getElementById(`check-${subject}`);
        if (checkbox.checked) selectedSubjects.push(subject);
      });

      const selectedExams = exams.filter(exam =>
        selectedSubjects.some(subject => subjectMap[subject].includes(exam.title))
      );

      let icsContent = "BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//DP1 Exam Calendar//EN\n";
      selectedExams.forEach(exam => {
        const start = new Date(exam.date);
        const end = new Date(start.getTime() + 60 * 60 * 1000); // +1 hour
        const dtStart = start.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
        const dtEnd = end.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
        icsContent += `BEGIN:VEVENT\nSUMMARY:${exam.title}\nDTSTART:${dtStart}\nDTEND:${dtEnd}\nEND:VEVENT\n`;
      });
      icsContent += "END:VCALENDAR";

      const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = 'exam_schedule.ics';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }
    // Pomodoro timer
    let pomodoroInterval;

    function startTimer(duration) {
      clearInterval(pomodoroInterval);
      let timer = duration, minutes, seconds;
      const display = document.getElementById('pomodoroDisplay');
      pomodoroInterval = setInterval(() => {
        minutes = Math.floor(timer / 60);
        seconds = timer % 60;
        display.textContent = `${minutes}m ${seconds < 10 ? '0' : ''}${seconds}s`;
        if (--timer < 0) {
          clearInterval(pomodoroInterval);
          display.textContent = '‚è∞ Time\'s up!';
        }
      }, 1000);
    }
  </script>
</body>
</html>
  <!-- Footer -->
  <footer class="text-center mt-5 mb-3 text-muted">
    DP1 Exam Assistant ¬© 2025
  </footer>